var t;(0,(t=("undefined"!=typeof globalThis?globalThis:"undefined"!=typeof self?self:"undefined"!=typeof window?window:"undefined"!=typeof global?global:{}).parcelRequiree2db).register)("6eYJP",function(e,a){Object.defineProperty(e.exports,"diagram",{get:function(){return k},set:void 0,enumerable:!0,configurable:!0});var i,r=t("76wyh"),n=t("Knj1d"),d=t("1RzZk"),s=t("ewvVJ"),o=t("5GUWQ");t("6fO6W"),t("biwpL"),t("gyk94"),t("cDk4l");var c={},g=function(t,e){c[t]=e},l=function(t,e){var a=t.append("text").attr("x",2*(0,o.c)().state.padding).attr("y",(0,o.c)().state.textHeight+2*(0,o.c)().state.padding).attr("font-size",(0,o.c)().state.fontSize).attr("class","state-title").text(e.id),i=a.node().getBBox();return t.insert("rect",":first-child").attr("x",(0,o.c)().state.padding).attr("y",(0,o.c)().state.padding).attr("width",i.width+2*(0,o.c)().state.padding).attr("height",i.height+2*(0,o.c)().state.padding).attr("rx",(0,o.c)().state.radius),a},p=function(t,e){var a=function(t,e,a){var i=t.append("tspan").attr("x",2*(0,o.c)().state.padding).text(e);a||i.attr("dy",(0,o.c)().state.textHeight)},i=t.append("text").attr("x",2*(0,o.c)().state.padding).attr("y",(0,o.c)().state.textHeight+1.3*(0,o.c)().state.padding).attr("font-size",(0,o.c)().state.fontSize).attr("class","state-title").text(e.descriptions[0]).node().getBBox(),r=i.height,n=t.append("text").attr("x",(0,o.c)().state.padding).attr("y",r+.4*(0,o.c)().state.padding+(0,o.c)().state.dividerMargin+(0,o.c)().state.textHeight).attr("class","state-description"),d=!0,s=!0;e.descriptions.forEach(function(t){d||(a(n,t,s),s=!1),d=!1});var c=t.append("line").attr("x1",(0,o.c)().state.padding).attr("y1",(0,o.c)().state.padding+r+(0,o.c)().state.dividerMargin/2).attr("y2",(0,o.c)().state.padding+r+(0,o.c)().state.dividerMargin/2).attr("class","descr-divider"),g=n.node().getBBox(),l=Math.max(g.width,i.width);return c.attr("x2",l+3*(0,o.c)().state.padding),t.insert("rect",":first-child").attr("x",(0,o.c)().state.padding).attr("y",(0,o.c)().state.padding).attr("width",l+2*(0,o.c)().state.padding).attr("height",g.height+r+2*(0,o.c)().state.padding).attr("rx",(0,o.c)().state.radius),t},h=function(t,e,a){var i,r=(0,o.c)().state.padding,n=2*(0,o.c)().state.padding,d=t.node().getBBox(),s=d.width,c=d.x,g=t.append("text").attr("x",0).attr("y",(0,o.c)().state.titleShift).attr("font-size",(0,o.c)().state.fontSize).attr("class","state-title").text(e.id),l=g.node().getBBox().width+n,p=Math.max(l,s);p===s&&(p+=n);var h=t.node().getBBox();e.doc,i=c-r,l>s&&(i=(s-p)/2+r),Math.abs(c-h.x)<r&&l>s&&(i=c-(l-s)/2);var u=1-(0,o.c)().state.textHeight;return t.insert("rect",":first-child").attr("x",i).attr("y",u).attr("class",a?"alt-composit":"composit").attr("width",p).attr("height",h.height+(0,o.c)().state.textHeight+(0,o.c)().state.titleShift+1).attr("rx","0"),g.attr("x",i+r),l<=s&&g.attr("x",c+(p-n)/2-l/2+r),t.insert("rect",":first-child").attr("x",i).attr("y",(0,o.c)().state.titleShift-(0,o.c)().state.textHeight-(0,o.c)().state.padding).attr("width",p).attr("height",3*(0,o.c)().state.textHeight).attr("rx",(0,o.c)().state.radius),t.insert("rect",":first-child").attr("x",i).attr("y",(0,o.c)().state.titleShift-(0,o.c)().state.textHeight-(0,o.c)().state.padding).attr("width",p).attr("height",h.height+3+2*(0,o.c)().state.textHeight).attr("rx",(0,o.c)().state.radius),t},u=function(t,e){var a=(0,o.c)().state.forkWidth,i=(0,o.c)().state.forkHeight;if(e.parentId){var r=a;a=i,i=r}return t.append("rect").style("stroke","black").style("fill","black").attr("width",a).attr("height",i).attr("x",(0,o.c)().state.padding).attr("y",(0,o.c)().state.padding)},x=function(t,e,a,i){var r=0,n=i.append("text");n.style("text-anchor","start"),n.attr("class","noteText");var d=t.replace(/\r\n/g,"<br/>"),s=(d=d.replace(/\n/g,"<br/>")).split(o.e.lineBreakRegex),c=1.25*(0,o.c)().state.noteMargin,g=!0,l=!1,p=void 0;try{for(var h,u=s[Symbol.iterator]();!(g=(h=u.next()).done);g=!0){var x=h.value.trim();if(x.length>0){var f=n.append("tspan");if(f.text(x),0===c){var y=f.node().getBBox();c+=y.height}r+=c,f.attr("x",e+(0,o.c)().state.noteMargin),f.attr("y",a+r+1.25*(0,o.c)().state.noteMargin)}}}catch(t){l=!0,p=t}finally{try{g||null==u.return||u.return()}finally{if(l)throw p}}return{textWidth:n.node().getBBox().width,textHeight:r}},f=function(t,e){e.attr("class","state-note");var a=e.append("rect").attr("x",0).attr("y",(0,o.c)().state.padding),i=x(t,0,0,e.append("g")),r=i.textWidth,n=i.textHeight;return a.attr("height",n+2*(0,o.c)().state.noteMargin),a.attr("width",r+2*(0,o.c)().state.noteMargin),a},y=function(t,e){var a=e.id,i={id:a,label:e.id,width:0,height:0},r=t.append("g").attr("id",a).attr("class","stateGroup");"start"===e.type&&r.append("circle").attr("class","start-state").attr("r",(0,o.c)().state.sizeUnit).attr("cx",(0,o.c)().state.padding+(0,o.c)().state.sizeUnit).attr("cy",(0,o.c)().state.padding+(0,o.c)().state.sizeUnit),"end"===e.type&&(r.append("circle").attr("class","end-state-outer").attr("r",(0,o.c)().state.sizeUnit+(0,o.c)().state.miniPadding).attr("cx",(0,o.c)().state.padding+(0,o.c)().state.sizeUnit+(0,o.c)().state.miniPadding).attr("cy",(0,o.c)().state.padding+(0,o.c)().state.sizeUnit+(0,o.c)().state.miniPadding),r.append("circle").attr("class","end-state-inner").attr("r",(0,o.c)().state.sizeUnit).attr("cx",(0,o.c)().state.padding+(0,o.c)().state.sizeUnit+2).attr("cy",(0,o.c)().state.padding+(0,o.c)().state.sizeUnit+2)),("fork"===e.type||"join"===e.type)&&u(r,e),"note"===e.type&&f(e.note.text,r),"divider"===e.type&&r.append("line").style("stroke","grey").style("stroke-dasharray","3").attr("x1",(0,o.c)().state.textHeight).attr("class","divider").attr("x2",2*(0,o.c)().state.textHeight).attr("y1",0).attr("y2",0),"default"===e.type&&0===e.descriptions.length&&l(r,e),"default"===e.type&&e.descriptions.length>0&&p(r,e);var n=r.node().getBBox();return i.width=n.width+2*(0,o.c)().state.padding,i.height=n.height+2*(0,o.c)().state.padding,g(a,i),i},v=0,w=function(t,e,a){e.points=e.points.filter(function(t){return!Number.isNaN(t.y)});var i=e.points,d=(0,n.line)().x(function(t){return t.x}).y(function(t){return t.y}).curve(n.curveBasis),s=t.append("path").attr("d",d(i)).attr("id","edge"+v).attr("class","transition"),c="";if((0,o.c)().state.arrowMarkerAbsolute&&(c=(c=(c=window.location.protocol+"//"+window.location.host+window.location.pathname+window.location.search).replace(/\(/g,"\\(")).replace(/\)/g,"\\)")),s.attr("marker-end","url("+c+"#"+function(t){switch(t){case r.d.relationType.AGGREGATION:return"aggregation";case r.d.relationType.EXTENSION:return"extension";case r.d.relationType.COMPOSITION:return"composition";case r.d.relationType.DEPENDENCY:return"dependency"}}(r.d.relationType.DEPENDENCY)+"End)"),void 0!==a.title){for(var g=t.append("g").attr("class","stateLabel"),l=(0,o.u).calcLabelPosition(e.points),p=l.x,h=l.y,u=(0,o.e).getRows(a.title),x=0,f=[],y=0,w=0,b=0;b<=u.length;b++){var m=g.append("text").attr("text-anchor","middle").text(u[b]).attr("x",p).attr("y",h+x),B=m.node().getBBox();y=Math.max(y,B.width),w=Math.min(w,B.x),(0,o.l).info(B.x,p,h+x),0===x&&(x=m.node().getBBox().height,(0,o.l).info("Title height",x,h)),f.push(m)}var k=x*u.length;if(u.length>1){var N=(u.length-1)*x*.5;f.forEach(function(t,e){return t.attr("y",h+e*x-N)}),k=x*u.length}var E=g.node().getBBox();g.insert("rect",":first-child").attr("class","box").attr("x",p-y/2-(0,o.c)().state.padding/2).attr("y",h-k/2-(0,o.c)().state.padding/2-3.5).attr("width",y+(0,o.c)().state.padding).attr("height",k+(0,o.c)().state.padding),(0,o.l).info(E)}v++},b={},m=function(t){t.append("defs").append("marker").attr("id","dependencyEnd").attr("refX",19).attr("refY",7).attr("markerWidth",20).attr("markerHeight",28).attr("orient","auto").append("path").attr("d","M 19,7 L9,13 L14,7 L9,1 Z")},B=function(t,e,a,r,n,c,g){var l=new s.Graph({compound:!0,multigraph:!0}),p=!0;for(N=0;N<t.length;N++)if("relation"===t[N].stmt){p=!1;break}a?l.setGraph({rankdir:"LR",multigraph:!0,compound:!0,ranker:"tight-tree",ranksep:p?1:i.edgeLengthFactor,nodeSep:p?1:50,isMultiGraph:!0}):l.setGraph({rankdir:"TB",multigraph:!0,compound:!0,ranksep:p?1:i.edgeLengthFactor,nodeSep:p?1:50,ranker:"tight-tree",isMultiGraph:!0}),l.setDefaultEdgeLabel(function(){return{}}),g.db.extract(t);var u=g.db.getStates(),x=g.db.getRelations(),f=Object.keys(u),v=!0,m=!1,k=void 0;try{for(var N,E,M=f[Symbol.iterator]();!(v=(E=M.next()).done);v=!0){var S=u[E.value];a&&(S.parentId=a);var z=void 0;if(S.doc){var H=e.append("g").attr("id",S.id).attr("class","stateGroup");z=B(S.doc,H,S.id,!r,n,c,g);var T=(H=h(H,S,r)).node().getBBox();z.width=T.width,z.height=T.height+i.padding/2,b[S.id]={y:i.compositTitleSize}}else z=y(e,S);if(S.note){var G={descriptions:[],id:S.id+"-note",note:S.note,type:"note"},L=y(e,G);"left of"===S.note.position?(l.setNode(z.id+"-note",L),l.setNode(z.id,z)):(l.setNode(z.id,z),l.setNode(z.id+"-note",L)),l.setParent(z.id,z.id+"-group"),l.setParent(z.id+"-note",z.id+"-group")}else l.setNode(z.id,z)}}catch(t){m=!0,k=t}finally{try{v||null==M.return||M.return()}finally{if(m)throw k}}(0,o.l).debug("Count=",l.nodeCount(),l);var O=0;x.forEach(function(t){var e;O++,(0,o.l).debug("Setting edge",t),l.setEdge(t.id1,t.id2,{relation:t,width:(e=t.title)?e.length*i.fontSizeFactor:1,height:i.labelHeight*(0,o.e).getRows(t.title).length,labelpos:"c"},"id"+O)}),(0,d.layout)(l),(0,o.l).debug("Graph after layout",l.nodes());var P=e.node();l.nodes().forEach(function(t){void 0!==t&&void 0!==l.node(t)?((0,o.l).warn("Node "+t+": "+JSON.stringify(l.node(t))),n.select("#"+P.id+" #"+t).attr("transform","translate("+(l.node(t).x-l.node(t).width/2)+","+(l.node(t).y+(b[t]?b[t].y:0)-l.node(t).height/2)+" )"),n.select("#"+P.id+" #"+t).attr("data-x-shift",l.node(t).x-l.node(t).width/2),c.querySelectorAll("#"+P.id+" #"+t+" .divider").forEach(function(t){var e=t.parentElement,a=0,i=0;e&&(e.parentElement&&(a=e.parentElement.getBBox().width),Number.isNaN(i=parseInt(e.getAttribute("data-x-shift"),10))&&(i=0)),t.setAttribute("x1",0-i+8),t.setAttribute("x2",a-i-8)})):(0,o.l).debug("No Node "+t+": "+JSON.stringify(l.node(t)))});var D=P.getBBox();l.edges().forEach(function(t){void 0!==t&&void 0!==l.edge(t)&&((0,o.l).debug("Edge "+t.v+" -> "+t.w+": "+JSON.stringify(l.edge(t))),w(e,l.edge(t),l.edge(t).relation))}),D=P.getBBox();var R={id:a||"root",label:a||"root",width:0,height:0};return R.width=D.width+2*i.padding,R.height=D.height+2*i.padding,(0,o.l).debug("Doc rendered",R,l),R},k={parser:r.p,db:r.d,renderer:{setConf:function(){},draw:function(t,e,a,r){i=(0,o.c)().state;var d,s=(0,o.c)().securityLevel;"sandbox"===s&&(d=(0,n.select)("#i"+e));var c="sandbox"===s?(0,n.select)(d.nodes()[0].contentDocument.body):(0,n.select)("body"),g="sandbox"===s?d.nodes()[0].contentDocument:document;(0,o.l).debug("Rendering diagram "+t);var l=c.select("[id='".concat(e,"']"));m(l),B(r.db.getRootDoc(),l,void 0,!1,c,g,r);var p=i.padding,h=l.node().getBBox(),u=h.width+2*p,x=h.height+2*p;(0,o.i)(l,x,1.75*u,i.useMaxWidth),l.attr("viewBox","".concat(h.x-i.padding,"  ").concat(h.y-i.padding," ")+u+" "+x)}},styles:r.s,init:function(t){t.state||(t.state={}),t.state.arrowMarkerAbsolute=t.arrowMarkerAbsolute,(0,r.d).clear()}}});
//# sourceMappingURL=stateDiagram-0ff1cf1a.6604e346.js.map
